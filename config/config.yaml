# SDS Configuration

video:
  source: 0  # 0 = webcam, "rtsp://..." for IP camera, "video.mp4" for file
  fps: 30
  resize_width: 1280
  resize_height: 720

detection:
  model: "yolov8s.pt"  # nano (fastest), s, m, l, x
  confidence: 0.2
  iou_threshold: 0.45
  classes: [0]  # 0 = person in COCO
  device: "cpu"  # cpu for Streamlit Cloud
  imgsz: 960       # larger input size for better recall on crowds
  augment: true    # enable TTA for prediction on images
  max_det: 1000    # allow many people in dense scenes
  tta_scales: [1.0, 1.25]   # additional test-time scales (relative to imgsz)
  flip_tta: true            # also run a horizontal flip pass
  nms_iou: 0.55             # IoU for NMS when merging TTA outputs

tracking:
  max_age: 30
  n_init: 3
  max_iou_distance: 0.7
  max_cosine_distance: 0.3
  nn_budget: 100
  use_appearance: true

density:
  enabled: true
  grid_size: [8, 6]
  thresholds:
    low: 5
    medium: 15
    high: 30
    critical: 50
  heatmap_alpha: 0.4

flow:
  enabled: true
  method: "farneback"
  flow_interval: 5
  vector_scale: 3
  min_flow_magnitude: 2.0
  arrow_density: 20

threats:
  enabled: true
  panic:
    speed_threshold: 5.0
    density_spike: 2.0
  stampede:
    opposing_flow_angle: 135
    high_density_threshold: 40
  unattended_object:
    stationary_time: 30
    size_threshold: [50, 50]
  collapse:
    motionless_time: 10
    on_ground_aspect_ratio: 2.5
  restricted_zones: []

visualization:
  show_bboxes: true
  show_ids: false
  show_density_heatmap: true
  show_flow_arrows: true
  show_threats: true
  show_display: true
  font_scale: 0.45
  line_thickness: 1

output:
  save_video: true
  output_dir: "results"
  show_fps: true
  log_events: true
